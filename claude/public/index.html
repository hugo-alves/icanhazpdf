<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Paper Fetcher</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            cream: '#FDF6E3',
            sage: '#E8F5E9',
            solar: {
              green: '#22C55E',
              lime: '#84CC16',
              amber: '#F59E0B',
              coral: '#FB7185',
              teal: '#14B8A6',
              sky: '#38BDF8',
            }
          },
          fontFamily: {
            mono: ['Space Mono', 'monospace'],
            display: ['Space Grotesk', 'sans-serif'],
          },
          boxShadow: {
            brutal: '4px 4px 0px 0px #000',
            'brutal-lg': '6px 6px 0px 0px #000',
            'brutal-sm': '2px 2px 0px 0px #000',
            'brutal-hover': '6px 6px 0px 0px #000',
          }
        }
      }
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Space+Mono:wght@400;700&display=swap');

    body {
      font-family: 'Space Grotesk', sans-serif;
      background: #FDF6E3;
      background-image:
        radial-gradient(circle at 20% 80%, rgba(34, 197, 94, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(245, 158, 11, 0.12) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(132, 204, 22, 0.08) 0%, transparent 70%);
    }

    .brutal-border {
      border: 3px solid #000;
    }

    .brutal-border-thick {
      border: 4px solid #000;
    }

    .hover-lift {
      transition: all 0.15s ease;
    }

    .hover-lift:hover {
      transform: translate(-2px, -2px);
      box-shadow: 6px 6px 0px 0px #000;
    }

    .hover-lift:active {
      transform: translate(0px, 0px);
      box-shadow: 2px 2px 0px 0px #000;
    }

    .plant-pattern {
      position: relative;
    }

    .plant-pattern::before {
      content: 'üåø';
      position: absolute;
      top: -12px;
      right: -12px;
      font-size: 24px;
      transform: rotate(15deg);
    }

    .marquee {
      animation: scroll 20s linear infinite;
    }

    @keyframes scroll {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    .loading-dots::after {
      content: '';
      animation: dots 1.5s steps(4, end) infinite;
    }

    @keyframes dots {
      0%, 20% { content: ''; }
      40% { content: '.'; }
      60% { content: '..'; }
      80%, 100% { content: '...'; }
    }
  </style>
</head>
<body class="min-h-screen">
  <!-- Decorative corner plants -->
  <div class="fixed top-4 left-4 text-4xl opacity-60 pointer-events-none select-none">üå±</div>
  <div class="fixed top-4 right-4 text-4xl opacity-60 pointer-events-none select-none">üåø</div>
  <div class="fixed bottom-4 left-4 text-4xl opacity-60 pointer-events-none select-none">üçÉ</div>
  <div class="fixed bottom-4 right-4 text-4xl opacity-60 pointer-events-none select-none">üåª</div>

  <div class="container mx-auto px-4 py-8 md:py-12">
    <!-- Header -->
    <header class="text-center mb-10">
      <div class="inline-block brutal-border-thick bg-solar-green px-6 py-3 shadow-brutal-lg mb-6 rotate-[-1deg]">
        <h1 class="text-3xl md:text-5xl font-bold text-black tracking-tight font-display">
          PAPER FETCHER
        </h1>
      </div>
      <p class="text-lg md:text-xl font-mono text-gray-800 max-w-xl mx-auto">
        Find academic papers from the open web
        <span class="inline-block ml-1">‚ú®</span>
      </p>
    </header>

    <!-- Main Search Card -->
    <main class="max-w-2xl mx-auto">
      <div class="brutal-border-thick bg-white shadow-brutal-lg p-6 md:p-8 plant-pattern">
        <form id="searchForm" class="space-y-5">
          <div>
            <label for="title" class="block text-sm font-bold text-black uppercase tracking-wide mb-2 font-mono">
              Paper Title
            </label>
            <input
              type="text"
              id="title"
              name="title"
              placeholder="e.g., Attention Is All You Need"
              class="w-full px-4 py-3 brutal-border bg-cream font-mono text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-0 focus:bg-amber-50 transition-colors"
              required
            >
          </div>
          <button
            type="submit"
            id="searchBtn"
            class="w-full brutal-border bg-solar-amber text-black py-3 px-6 font-bold uppercase tracking-wider hover-lift shadow-brutal disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-brutal-sm font-mono"
          >
            <span id="btnText">Search Papers</span>
          </button>
        </form>

        <!-- Results -->
        <div id="results" class="mt-8 hidden">
          <div class="border-t-4 border-black pt-6">
            <div class="flex items-center gap-2 mb-4">
              <span class="bg-black text-white px-2 py-1 text-xs font-mono uppercase">Result</span>
            </div>
            <div id="resultContent"></div>
          </div>
        </div>

        <!-- Error -->
        <div id="error" class="mt-6 hidden">
          <div class="brutal-border bg-solar-coral/20 p-4">
            <div class="flex items-start gap-2">
              <span class="text-xl">‚ö†Ô∏è</span>
              <p class="text-black font-mono text-sm" id="errorText"></p>
            </div>
          </div>
        </div>
      </div>

      <!-- Sources Info -->
      <div class="mt-8 brutal-border bg-sage shadow-brutal p-5">
        <div class="flex items-center gap-2 mb-4">
          <span class="text-xl">üìö</span>
          <h3 class="text-sm font-bold text-black uppercase tracking-wider font-mono">Data Sources</h3>
        </div>
        <div class="flex flex-wrap gap-2">
          <span class="brutal-border px-3 py-1.5 bg-solar-green text-black text-xs font-bold uppercase font-mono hover-lift shadow-brutal-sm cursor-default">arXiv</span>
          <span class="brutal-border px-3 py-1.5 bg-solar-sky text-black text-xs font-bold uppercase font-mono hover-lift shadow-brutal-sm cursor-default">Semantic Scholar</span>
          <span class="brutal-border px-3 py-1.5 bg-solar-lime text-black text-xs font-bold uppercase font-mono hover-lift shadow-brutal-sm cursor-default">OpenAlex</span>
          <span class="brutal-border px-3 py-1.5 bg-solar-amber text-black text-xs font-bold uppercase font-mono hover-lift shadow-brutal-sm cursor-default">PubMed</span>
          <span class="brutal-border px-3 py-1.5 bg-solar-coral text-black text-xs font-bold uppercase font-mono hover-lift shadow-brutal-sm cursor-default">CORE</span>
          <span class="brutal-border px-3 py-1.5 bg-solar-teal text-black text-xs font-bold uppercase font-mono hover-lift shadow-brutal-sm cursor-default">Crossref</span>
          <span class="brutal-border px-3 py-1.5 bg-white text-black text-xs font-bold uppercase font-mono hover-lift shadow-brutal-sm cursor-default">Web Search</span>
          <span class="brutal-border px-3 py-1.5 bg-cream text-black text-xs font-bold uppercase font-mono hover-lift shadow-brutal-sm cursor-default">Unpaywall</span>
        </div>
      </div>

      <!-- Footer -->
      <footer class="mt-10 text-center">
        <p class="font-mono text-sm text-gray-600">
          Open access research for everyone üåç
        </p>
      </footer>
    </main>
  </div>

  <script>
    const form = document.getElementById('searchForm');
    const results = document.getElementById('results');
    const resultContent = document.getElementById('resultContent');
    const error = document.getElementById('error');
    const errorText = document.getElementById('errorText');
    const searchBtn = document.getElementById('searchBtn');
    const btnText = document.getElementById('btnText');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const title = document.getElementById('title').value.trim();
      if (!title) return;

      // Reset UI
      results.classList.add('hidden');
      error.classList.add('hidden');
      searchBtn.disabled = true;
      btnText.innerHTML = '<span class="loading-dots">Searching</span>';

      try {
        const response = await fetch('/api/fetch', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ title })
        });

        const data = await response.json();

        if (data.success) {
          results.classList.remove('hidden');
          resultContent.innerHTML = `
            <div class="brutal-border bg-solar-green/20 p-4 space-y-4">
              <div class="flex items-center flex-wrap gap-2">
                <span class="text-2xl">üåø</span>
                <span class="font-bold text-black uppercase font-mono">Found!</span>
                <span class="brutal-border px-2 py-0.5 bg-solar-lime text-black text-xs font-bold uppercase font-mono">${data.source}</span>
              </div>
              ${data.metadata?.title ? `<p class="font-bold text-black text-lg">${data.metadata.title}</p>` : ''}
              ${data.metadata?.authors ? `<p class="text-gray-700 font-mono text-sm">${data.metadata.authors}</p>` : ''}
              <a
                href="${data.pdf_url}"
                target="_blank"
                class="inline-flex items-center gap-2 brutal-border bg-solar-green text-black px-4 py-2 font-bold uppercase font-mono text-sm hover-lift shadow-brutal-sm"
              >
                <span>Download PDF</span>
                <span>‚Üì</span>
              </a>
            </div>
          `;
        } else {
          error.classList.remove('hidden');
          errorText.textContent = data.error || 'Paper not found in any source. Try a different title!';
        }
      } catch (err) {
        error.classList.remove('hidden');
        errorText.textContent = 'Connection error: ' + err.message;
      } finally {
        searchBtn.disabled = false;
        btnText.innerHTML = 'Search Papers';
      }
    });
  </script>
</body>
</html>
